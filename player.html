<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="referrer" content="strict-origin-when-cross-origin" />

<style>
html, body {
  margin: 0;
  width: 100%;
  height: 100%;
  background: #000;
  overflow: hidden;
  font-family: system-ui, -apple-system;
}

#player-root {
  position: relative;
  width: 100%;
  height: 100%;
}

/* IMPORTANT: iframe stays visible */
#youTubePlayer {
  position: absolute;
  inset: 0;
  z-index: 1;
}

/* ================= CONTROLS ================= */

.controls {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  padding: 12px;
  z-index: 2;

  /* VERY IMPORTANT */
  pointer-events: none;

  background: linear-gradient(
    to top,
    rgba(0,0,0,.7),
    rgba(0,0,0,.35),
    rgba(0,0,0,0)
  );
}

.controls * {
  pointer-events: auto;
}

.seekbar {
  width: 100%;
  height: 4px;
  appearance: none;
  background: rgba(255,255,255,.25);
  border-radius: 3px;
}

.seekbar::-webkit-slider-thumb {
  appearance: none;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: #ff0000;
}

.row {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-top: 8px;
}

button {
  background: none;
  border: none;
  padding: 0;
  cursor: pointer;
  color: white;
}

.time {
  font-size: 12px;
  color: rgba(255,255,255,.85);
  min-width: 90px;
}

.volume-group {
  display: flex;
  align-items: center;
  gap: 6px;
  width: 110px;
}

.volume {
  width: 70px;
  height: 4px;
  appearance: none;
  background: rgba(255,255,255,.25);
  border-radius: 3px;
}

.volume::-webkit-slider-thumb {
  appearance: none;
  width: 10px;
  height: 10px;
  background: #ff0000;
  border-radius: 50%;
}

select {
  background: transparent;
  color: white;
  border: none;
  font-size: 13px;
}
</style>

<script src="https://www.youtube.com/iframe_api" async></script>
</head>

<body>

<div id="player-root">
  <div id="youTubePlayer"></div>

  <div class="controls">
    <input id="seekbar" class="seekbar" type="range" min="0" max="100" value="0">

    <div class="row">
      <button id="play"></button>

      <div class="volume-group">
        <button id="mute"></button>
        <input id="volume" class="volume" type="range" min="0" max="100" value="50">
      </div>

      <div id="time" class="time">0:00 / 0:00</div>

      <select id="speed">
        <option value="0.5">0.5x</option>
        <option value="1" selected>1x</option>
        <option value="1.5">1.5x</option>
        <option value="2">2x</option>
      </select>

      <button id="fullscreen">â›¶</button>
    </div>
  </div>
</div>

<script>
/* ================= WORKING PLAYER CODE (UNCHANGED) ================= */

const q = new URLSearchParams(location.search);
const videoId = q.get("videoId") || "";
const startAt = parseFloat(q.get("start") || "0");

let player, timer;

function onYouTubeIframeAPIReady() {
  player = new YT.Player("youTubePlayer", {
    width: "100%",
    height: "100%",
    playerVars: {
      autoplay: 1,
      controls: 0,
      enablejsapi: 1,
      mute: 1,
      playsinline: 1,
      origin: location.origin,
    },
    events: {
      onReady: () => videoId && player.loadVideoById(videoId, startAt),
      onStateChange: e => updatePlayIcon(e.data),
    },
  });
}

function playVideo() { player.playVideo(); }
function pauseVideo() { player.pauseVideo(); }
function seekTo(s) { player.seekTo(s, true); }
function mute() { player.mute(); }
function unMute() { player.unMute(); }
function setVolume(v) { player.setVolume(v); }
function setPlaybackRate(r) { player.setPlaybackRate(r); }

/* ================= UI ================= */

const playBtn = document.getElementById("play");
const muteBtn = document.getElementById("mute");
const seekbar = document.getElementById("seekbar");
const volume = document.getElementById("volume");
const time = document.getElementById("time");
const speed = document.getElementById("speed");
const fullscreen = document.getElementById("fullscreen");

playBtn.onclick = () =>
  player.getPlayerState() === 1 ? pauseVideo() : playVideo();

muteBtn.onclick = () => {
  player.isMuted() ? unMute() : mute();
  updateVolumeIcon();
};

volume.oninput = () => {
  setVolume(volume.value);
  volume.value == 0 ? mute() : unMute();
  updateVolumeIcon();
};

seekbar.oninput = () => {
  const d = player.getDuration();
  if (d) seekTo(d * (seekbar.value / 100));
};

speed.onchange = () => setPlaybackRate(parseFloat(speed.value));

fullscreen.onclick = () =>
  document.title = "ytplayer://onFullscreen";

function updatePlayIcon(state) {
  playBtn.innerHTML =
    state === 1
      ? `<svg width="18" height="18" fill="white" viewBox="0 0 24 24">
           <path d="M6 19h4V5H6zm8-14v14h4V5z"/>
         </svg>`
      : `<svg width="18" height="18" fill="white" viewBox="0 0 24 24">
           <path d="M8 5v14l11-7z"/>
         </svg>`;
}

function updateVolumeIcon() {
  muteBtn.innerHTML =
    volume.value == 0
      ? `<svg width="18" height="18" fill="white" viewBox="0 0 24 24">
           <path d="M3 10v4h4l5 5V5L7 10z"/>
           <line x1="16" y1="8" x2="22" y2="16" stroke="white" stroke-width="2"/>
         </svg>`
      : `<svg width="18" height="18" fill="white" viewBox="0 0 24 24">
           <path d="M3 10v4h4l5 5V5L7 10z"/>
         </svg>`;
}

updatePlayIcon(2);
updateVolumeIcon();
</script>

</body>
</html>
