<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Enhanced YouTube Player</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script defer src="https://www.youtube.com/iframe_api"></script>
<style>
* {margin:0; padding:0; box-sizing:border-box;}
body {background:#000; color:white; font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; height:100vh; overflow:hidden;}
#player-container {position:fixed; top:0; left:0; width:100%; height:100%; z-index:1;}
#youTubePlayer {width:100%; height:100%; display:block; pointer-events:none;}
.video-overlay {position:absolute; top:0; left:0; width:100%; height:100%; z-index:2; pointer-events:none;}
.controller-overlay {position:fixed; bottom:0; left:0; width:100%; background:rgba(0,0,0,0.7); padding:15px; z-index:10; transition:opacity 0.3s; opacity:1;}
.controller-overlay.hidden {opacity:0;}
.progress-container {display:flex; align-items:center; gap:10px; margin-bottom:15px;}
.time-display {font-size:14px; font-variant-numeric:tabular-nums; min-width:40px; text-align:center;}
.seek-bar {flex:1; height:6px; background:#444; border-radius:3px; position:relative; cursor:pointer;}
.progress {height:100%; background:#f00; border-radius:3px; width:0%; position:relative;}
.progress::after {content:''; position:absolute; right:-5px; top:50%; transform:translateY(-50%); width:12px; height:12px; background:#fff; border-radius:50%; opacity:0; transition:opacity 0.2s;}
.seek-bar:hover .progress::after {opacity:1;}
.controls {display:flex; justify-content:space-between; align-items:center;}
.left-controls, .right-controls {display:flex; align-items:center; gap:15px;}
.control-btn {background:transparent; border:none; color:white; font-size:18px; cursor:pointer; width:36px; height:36px; border-radius:50%; display:flex; align-items:center; justify-content:center; transition:background 0.2s; pointer-events:auto;}
.control-btn:hover {background:rgba(255,255,255,0.1);}
.volume-container {display:flex; align-items:center; gap:8px;}
.volume-slider {width:80px; -webkit-appearance:none; height:4px; border-radius:2px; background:#555; outline:none; transition:all 0.2s; opacity:0.7; pointer-events:auto;}
.volume-slider:hover {opacity:1;}
.volume-slider::-webkit-slider-thumb {-webkit-appearance:none; width:12px; height:12px; border-radius:50%; background:#fff; cursor:pointer;}
.playback-speed {display:flex; align-items:center; gap:8px;}
select {background:rgba(255,255,255,0.1); color:white; border:1px solid rgba(255,255,255,0.2); padding:6px 10px; border-radius:4px; cursor:pointer; pointer-events:auto;}
.video-title {position:absolute; top:20px; left:20px; font-size:18px; background:rgba(0,0,0,0.5); padding:8px 15px; border-radius:4px; max-width:80%; z-index:5; pointer-events:none; transition:opacity 0.3s; opacity:1;}
.video-title.hidden {opacity:0;}
.cursor-trail {position:fixed; width:20px; height:20px; background:rgba(255,255,255,0.5); border-radius:50%; pointer-events:none; transform:translate(-50%, -50%); z-index:9999; transition:opacity 0.3s; opacity:0;}
.cursor-trail.visible {opacity:1;}
.thumbnail-overlay {position:absolute; top:0; left:0; width:100%; height:100%; z-index:3; background-color:#000; background-size:cover; background-position:center; display:flex; align-items:center; justify-content:center; transition:opacity 0.3s; opacity:1; pointer-events:none;}
.thumbnail-overlay.hidden {opacity:0; pointer-events:none;}
.loading-indicator {position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); z-index:4; pointer-events:none; display:flex; flex-direction:column; align-items:center; gap:15px;}
.spinner {width:50px; height:50px; border:5px solid rgba(255,255,255,0.3); border-radius:50%; border-top:5px solid #fff; animation:spin 1s linear infinite;}
@keyframes spin {0% { transform: rotate(0deg);} 100% {transform:rotate(360deg);}}
.loading-text {font-size:18px; color:white; text-shadow:0 0 5px rgba(0,0,0,0.8);}
.center-button {position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); z-index:4; display:flex; flex-direction:column; align-items:center; justify-content:center; cursor:pointer; transition:transform 0.2s, opacity 0.2s; pointer-events:auto; text-align:center;}
.play-center-btn {width:200px; height:200px; background:rgba(255,0,0,0.7); border-radius:50%; z-index:4; opacity:0.9;}
.play-center-btn:hover {transform:translate(-50%, -50%) scale(1.1); opacity:1; background:rgba(255,0,0,0.9);}
.play-center-btn i {font-size:36px; color:white; margin-left:5px;}
.unmute-center-btn {width:180px; height:180px; background:rgba(0,0,0,0.7); border-radius:50%; border:3px solid rgba(255,255,255,0.5); padding:20px; opacity:0.9;}
.unmute-center-btn:hover {transform:translate(-50%, -50%) scale(1.05); opacity:1; background:rgba(0,0,0,0.8);}
.unmute-icon {font-size:60px; color:white; margin-bottom:15px;}
.unmute-text {font-size:18px; font-weight:bold; color:white; text-transform:uppercase; letter-spacing:1px;}
.thumbnail-overlay .center-button {opacity:0; transition:opacity 0.3s;}
.thumbnail-overlay:hover .center-button {opacity:1;}
.thumbnail-overlay.hidden .center-button {display:none;}
@media (max-width:768px) {.controller-overlay{padding:10px;}.control-btn{width:32px;height:32px;font-size:16px;}.volume-slider{width:60px;}.video-title{font-size:14px;top:10px;left:10px;}.play-center-btn{width:200px;height:200px;}.play-center-btn i{font-size:24px;}.unmute-center-btn{width:140px;height:140px;}.unmute-icon{font-size:40px;}.unmute-text{font-size:14px;}.spinner{width:40px;height:40px;border-width:4px;}.loading-text{font-size:16px;}}
</style>
</head>
<body>
<div id="player-container">
    <div id="youTubePlayer"></div>
    <div class="cursor-trail" id="cursorTrail"></div>
    <div class="video-overlay" id="videoOverlay"></div>
    <div class="thumbnail-overlay" id="thumbnailOverlay"></div>
    <div class="loading-indicator" id="loadingIndicator">
        <div class="spinner"></div>
        <div class="loading-text">Loading Video...</div>
    </div>
    <div class="center-button play-center-btn" id="playCenterBtn"><i class="fas fa-play"></i></div>
    <div class="center-button unmute-center-btn" id="unmuteCenterBtn">
        <div class="unmute-icon"><i class="fas fa-volume-mute"></i></div>
        <div class="unmute-text">Click to Unmute</div>
    </div>
    <div class="video-title" id="videoTitle" hidden>Best Book for LLB Entrance Exam Preparation</div>
</div>

<div class="controller-overlay" id="controllerOverlay">
    <div class="progress-container">
        <div class="time-display" id="currentTime">0:00</div>
        <div class="seek-bar" id="seekBar"><div class="progress" id="progress"></div></div>
        <div class="time-display" id="duration">0:00</div>
    </div>
    <div class="controls">
        <div class="left-controls">
            <button class="control-btn" id="playPauseBtn"><i class="fas fa-play"></i></button>
            <button class="control-btn" id="muteBtn"><i class="fas fa-volume-up"></i></button>
            <div class="volume-container"><input type="range" min="0" max="100" value="80" class="volume-slider" id="volumeSlider"></div>
            <div class="time-display" id="timeIndicator">0:00 / 0:00</div>
        </div>
        <div class="right-controls">
            <div class="playback-speed">
                <select id="speedSelect">
                    <option value="0.25">0.25x</option>
                    <option value="0.5">0.5x</option>
                    <option value="0.75">0.75x</option>
                    <option value="1" selected>1x</option>
                    <option value="1.25">1.25x</option>
                    <option value="1.5">1.5x</option>
                    <option value="1.75">1.75x</option>
                    <option value="2">2x</option>
                </select>
            </div>
        </div>
    </div>
</div>

<script>
// --- Variables ---
var player, isSeeking=false, controllerTimeout, timerId;
const playPauseBtn=document.getElementById('playPauseBtn');
const muteBtn=document.getElementById('muteBtn');
const volumeSlider=document.getElementById('volumeSlider');
const speedSelect=document.getElementById('speedSelect');
const currentTimeDisplay=document.getElementById('currentTime');
const durationDisplay=document.getElementById('duration');
const timeIndicator=document.getElementById('timeIndicator');
const seekBar=document.getElementById('seekBar');
const progress=document.getElementById('progress');
const controllerOverlay=document.getElementById('controllerOverlay');
const videoTitle=document.getElementById('videoTitle');
const videoOverlay=document.getElementById('videoOverlay');
const cursorTrail=document.getElementById('cursorTrail');
const thumbnailOverlay=document.getElementById('thumbnailOverlay');
const loadingIndicator=document.getElementById('loadingIndicator');
const playCenterBtn=document.getElementById('playCenterBtn');
const unmuteCenterBtn=document.getElementById('unmuteCenterBtn');

const urlParams=new URLSearchParams(window.location.search);
const videoId=urlParams.get('videoId')||'bUrEs2l0gss';
const startAt=parseFloat(urlParams.get('start')||'0');

// --- Helpers ---
function formatTime(s){const m=Math.floor(s/60);const sec=Math.floor(s%60);return `${m}:${sec<10?'0':''}${sec}`;}
function dispatchCallback(name,data){document.title=`ytplayer://${name}?data=${data}`;}

// --- Initialize YouTube Player ---
function onYouTubeIframeAPIReady(){
    player=new YT.Player('youTubePlayer',{
        width:'100%', height:'100%', videoId:videoId,
        playerVars:{
            disablekb:1, autoplay:1, controls:0, cc_load_policy:0, fs:1, iv_load_policy:3,
            rel:0, loop:1, enablejsapi:1, mute:1, playsinline:1, origin:location.origin, modestbranding:1, showinfo:0
        },
        events:{
            onReady:onPlayerReady,
            onStateChange:onPlayerStateChange,
            onError:onPlayerError
        }
    });
}

// --- Player Ready ---
function onPlayerReady(){
    player.setVolume(parseInt(volumeSlider.value));
    player.setPlaybackRate(parseFloat(speedSelect.value));
    setThumbnailBackground();
    dispatchCallback('onVideoId',videoId);
    if(startAt>0) player.seekTo(startAt,true);
    const duration=player.getDuration();
    durationDisplay.textContent=formatTime(duration);
    timeIndicator.textContent=`0:00 / ${formatTime(duration)}`;
    setInterval(updateUI,100);
    startControllerTimeout();
}

// --- Thumbnail ---
function setThumbnailBackground(){thumbnailOverlay.style.backgroundImage=`url('https://img.youtube.com/vi/${videoId}/maxresdefault.jpg')`;}

// --- Update UI ---
function updateUI(){
    if(!player||typeof player.getCurrentTime!=='function') return;
    const currentTime=player.getCurrentTime();
    currentTimeDisplay.textContent=formatTime(currentTime);
    timeIndicator.textContent=`${formatTime(currentTime)} / ${formatTime(player.getDuration())}`;
    if(!isSeeking){const percent=(currentTime/player.getDuration())*100; progress.style.width=`${percent}%`;}
    if(player.isMuted()&&player.getPlayerState()===YT.PlayerState.PLAYING) showUnmuteButton();
    dispatchCallback('onCurrentTimeChange',currentTime);
    dispatchCallback('onVideoDuration',player.getDuration());
}

// --- Play/Pause Icon ---
function updatePlayPauseIcon(){const icon=playPauseBtn.querySelector('i');if(player.getPlayerState()===YT.PlayerState.PLAYING){icon.classList.remove('fa-play');icon.classList.add('fa-pause');}else{icon.classList.remove('fa-pause');icon.classList.add('fa-play');}}

// --- Show/Hide Unmute ---
function showUnmuteButton(){unmuteCenterBtn.style.display='flex';setTimeout(()=>{unmuteCenterBtn.style.opacity='1';},100);}
function hideUnmuteButton(){unmuteCenterBtn.style.opacity='0';setTimeout(()=>{unmuteCenterBtn.style.display='none';},300);}

// --- Player State Change ---
function onPlayerStateChange(event){
    updatePlayPauseIcon();
    dispatchCallback('onStateChange',event.data);
    clearInterval(timerId);
    if(event.data===YT.PlayerState.PLAYING) timerId=setInterval(updateUI,200);
    if(event.data===YT.PlayerState.PLAYING){thumbnailOverlay.classList.add('hidden'); loadingIndicator.style.display='none'; playCenterBtn.style.display='none'; if(player.isMuted()) showUnmuteButton(); startControllerTimeout();}
    else if(event.data===YT.PlayerState.PAUSED){thumbnailOverlay.classList.remove('hidden'); loadingIndicator.style.display='none'; playCenterBtn.style.display='flex';}
    else if(event.data===YT.PlayerState.BUFFERING){thumbnailOverlay.classList.remove('hidden'); loadingIndicator.style.display='flex'; playCenterBtn.style.display='none';}
    else if(event.data===YT.PlayerState.ENDED||event.data===YT.PlayerState.CUED){thumbnailOverlay.classList.remove('hidden'); loadingIndicator.style.display='none'; playCenterBtn.style.display='flex';}
}

// --- Player Error ---
function onPlayerError(event){dispatchCallback('onError',event.data); loadingIndicator.querySelector('.loading-text').textContent='Error loading video';}

// --- Controls ---
playPauseBtn.addEventListener('click',()=>{if(player.getPlayerState()===YT.PlayerState.PLAYING) player.pauseVideo(); else player.playVideo(); updatePlayPauseIcon(); startControllerTimeout();});
playCenterBtn.addEventListener('click',()=>{player.playVideo(); updatePlayPauseIcon(); startControllerTimeout();});
unmuteCenterBtn.addEventListener('click',()=>{player.unMute(); player.playVideo(); muteBtn.querySelector('i').classList.remove('fa-volume-mute'); muteBtn.querySelector('i').classList.add('fa-volume-up'); hideUnmuteButton(); startControllerTimeout();});
muteBtn.addEventListener('click',()=>{if(player.isMuted()){player.unMute(); muteBtn.querySelector('i').classList.remove('fa-volume-mute'); muteBtn.querySelector('i').classList.add('fa-volume-up'); hideUnmuteButton();}else{player.mute(); muteBtn.querySelector('i').classList.remove('fa-volume-up'); muteBtn.querySelector('i').classList.add('fa-volume-mute');} startControllerTimeout();});
volumeSlider.addEventListener('input',function(){setVolume(this.value); startControllerTimeout();});
speedSelect.addEventListener('change',function(){player.setPlaybackRate(parseFloat(this.value)); startControllerTimeout();});

// --- Seek Bar ---
seekBar.addEventListener('mousedown', e=>{isSeeking=true; handleSeek(e);});
document.addEventListener('mousemove', e=>{if(isSeeking) handleSeek(e);});
document.addEventListener('mouseup', ()=>{isSeeking=false;});
seekBar.addEventListener('click', e=>{if(!isSeeking) handleSeek(e);});
function handleSeek(e){const rect=seekBar.getBoundingClientRect(); const percent=Math.max(0, Math.min(1,(e.clientX-rect.left)/rect.width)); const newTime=player.getDuration()*percent; player.seekTo(newTime,true); progress.style.width=`${percent*100}%`; startControllerTimeout();}

// --- Controller Timeout ---
function startControllerTimeout(){controllerOverlay.classList.remove('hidden'); videoTitle.classList.remove('hidden'); clearTimeout(controllerTimeout); controllerTimeout=setTimeout(()=>{controllerOverlay.classList.add('hidden'); videoTitle.classList.add('hidden');},3000);}

// --- Cursor & Keyboard ---
document.addEventListener('mousemove', e=>{cursorTrail.style.left=e.clientX+'px'; cursorTrail.style.top=e.clientY+'px'; cursorTrail.classList.add('visible'); controllerOverlay.classList.remove('hidden'); videoTitle.classList.remove('hidden'); startControllerTimeout(); setTimeout(()=>{cursorTrail.classList.remove('visible');},300);});
document.addEventListener('keydown', e=>{if(e.key===' '){e.preventDefault(); if(player.getPlayerState()===YT.PlayerState.PLAYING) player.pauseVideo(); else player.playVideo(); updatePlayPauseIcon(); startControllerTimeout();} else if(e.key==='ArrowRight'){player.seekTo(player.getCurrentTime()+5,true); startControllerTimeout();} else if(e.key==='ArrowLeft'){player.seekTo(player.getCurrentTime()-5,true); startControllerTimeout();} else if(e.key==='ArrowUp'){let vol=Math.min(100,player.getVolume()+5); setVolume(vol); volumeSlider.value=vol; startControllerTimeout();} else if(e.key==='ArrowDown'){let vol=Math.max(0,player.getVolume()-5); setVolume(vol); volumeSlider.value=vol; startControllerTimeout();}});

// --- Volume & Playback Functions ---
function setVolume(v){if(!player||typeof player.setVolume!=='function') return; v=Math.max(0,Math.min(100,Math.round(Number(v)))); if(window._volumeDebounceTimer) clearTimeout(window._volumeDebounceTimer); window._volumeDebounceTimer=setTimeout(()=>{player.setVolume(v); if(v===0) player.mute(); else player.unMute();},100);}
function loadVideo(id,sec){if(player&&player.loadVideoById){player.loadVideoById(id,sec||0); dispatchCallback('onVideoId',id);}}
function playVideo(){if(player&&player.playVideo) player.playVideo();}
function pauseVideo(){if(player&&player.pauseVideo) player.pauseVideo();}
function seekTo(s){if(player&&player.seekTo) player.seekTo(s,true);}
function mute(){if(player&&player.mute) player.mute();}
function unMute(){if(player&&player.unMute) player.unMute();}
function setPlaybackRate(r){if(player&&player.setPlaybackRate) player.setPlaybackRate(r);}

// --- Expose Globally ---
window.loadVideo=loadVideo;
window.playVideo=playVideo;
window.pauseVideo=pauseVideo;
window.seekTo=seekTo;
window.mute=mute;
window.unMute=unMute;
window.setVolume=setVolume;
window.setPlaybackRate=setPlaybackRate;
</script>
</body>
</html>
